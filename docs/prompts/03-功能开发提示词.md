# 功能开发提示词

本文档包含功能模块开发的提示词模板，涵盖前端、后端和全栈开发场景。

## 前端功能开发

### 提示词：实现前端功能

```
请为 MultiForms 项目实现 [功能名称] 功能。

# 功能概述

[详细描述要实现的功能]

# 技术栈

- **框架**: React 18+ with TypeScript
- **路由**: Next.js App Router / React Router
- **状态管理**: Zustand
- **表单**: React Hook Form + Zod
- **API**: Axios / Fetch
- **样式**: Tailwind CSS

# 相关文档

- 设计系统: docs/design/03-UI-UX设计系统.md
- 组件规范: docs/design/05-组件设计规范.md
- API 文档: docs/requirements/02-技术需求文档-TRD.md

# 实现要求

## 功能需求
1. [需求1]
2. [需求2]
3. [需求3]

## 技术要求
- 使用 TypeScript
- 遵循 ESLint 规则
- 组件化开发
- 响应式设计
- 错误处理
- Loading 状态

## 文件结构
```
src/features/[功能名]/
├── components/       # 功能相关组件
├── hooks/           # 自定义 Hooks
├── services/        # API 服务
├── types/           # TypeScript 类型
├── utils/           # 工具函数
└── index.tsx        # 入口文件
```

# 输出要求

1. 创建必要的文件
2. 实现功能逻辑
3. 添加类型定义
4. 处理错误情况
5. 添加注释说明

【自动验证】
完成后请自动执行以下验证：
1. 检查所有文件是否已创建
2. 验证类型定义是否完整
3. 运行 npx tsc --noEmit 检查类型错误
4. 运行 pnpm build 检查构建是否成功
5. 报告验证结果，如有问题请修复

请开始实现。
```

## 后端功能开发

### 提示词：实现后端 API

```
请为 MultiForms 项目实现 [API 名称] 后端接口。

# 技术栈

- **框架**: Next.js 15 (App Router) + Supabase
- **数据库**: PostgreSQL 16 (Supabase托管)
- **验证**: Zod
- **认证**: Supabase Auth (JWT)
- **存储**: Supabase Storage
- **实时**: Supabase Realtime

# API 规范

## 请求/响应格式
```typescript
// 统一响应格式
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
}
```

# 功能需求

## API 端点
- **方法**: [GET/POST/PUT/DELETE]
- **路径**: `/api/[路径]`
- **认证**: [需要/不需要]
- **限流**: [规则]

## 请求参数
```typescript
interface RequestDto {
  // 参数定义
}
```

## 响应数据
```typescript
interface ResponseDto {
  // 响应定义
}
```

## 业务逻辑
[描述具体的业务逻辑]

## 数据操作
- 读取: [涉及的表]
- 写入: [涉及的表]
- 缓存: [缓存策略]

# 输出要求

1. 创建/更新 Supabase Migration 文件
2. 创建 Supabase Edge Function (如需要复杂逻辑)
3. 创建 Next.js API Route Handler (如需要业务逻辑)
4. 添加 RLS 策略
5. 添加验证规则
6. 添加错误处理

【自动验证】
完成后请自动执行以下验证：
1. 检查迁移文件是否存在
2. 验证 SQL 语法是否正确
3. 运行 npx tsc --noEmit 检查类型错误
4. 报告验证结果，提醒用户手动运行 supabase db push
```

## 数据库操作

### 提示词：数据库迁移/查询

```
请为 MultiForms 项目执行 [数据库操作]。

# 数据库信息

- **类型**: PostgreSQL 16 (Supabase托管)
- **工具**: Supabase Migrations
- **Schema 文件**: supabase/migrations/

# 操作类型

[创建表 / 修改表 / 添加索引 / 创建迁移]

# 表结构

## 表名: [表名]

```sql
-- Supabase Migration SQL
CREATE TABLE public.[table_name] (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    -- 字段定义
);
```

# 字段说明

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| [字段] | [类型] | [说明] | [约束] |

# 索引

[需要创建的索引]

# 关系

[表之间的关系]

# 输出要求

1. 创建 Supabase Migration 文件
2. 添加 RLS 策略
3. 推送迁移到远程数据库
```

## 功能场景模板

### 1. 用户认证

```
# 用户认证功能

## 功能范围
- 用户注册（邮箱/社交）
- 用户登录
- 密码重置
- 刷新令牌
- 登出

## API 端点
- POST /api/auth/register
- POST /api/auth/login
- POST /api/auth/logout
- POST /api/auth/refresh
- POST /api/auth/forgot-password
- POST /api/auth/reset-password

## 安全要求
- 密码加密（bcrypt）
- JWT 令牌
- 令牌过期时间
- 刷新令牌机制
- 登录失败限制
```

### 2. 表单管理

```
# 表单管理功能

## 功能范围
- 创建表单
- 编辑表单
- 删除表单
- 复制表单
- 发布/取消发布
- 表单列表
- 表单详情

## API 端点
- POST /api/forms
- GET /api/forms
- GET /api/forms/:id
- PUT /api/forms/:id
- DELETE /api/forms/:id
- POST /api/forms/:id/duplicate
- POST /api/forms/:id/publish

## 数据验证
- 表单标题必填
- 至少包含一个问题
- 发布前验证完整性
```

### 3. 表单提交

```
# 表单提交功能

## 功能范围
- 公开表单填写
- 提交表单
- 提交确认
- 提交历史（已登录）
- 草稿保存

## API 端点
- GET /api/f/:shortId
- POST /api/f/:shortId/submit
- GET /api/f/:shortId/submissions
- POST /api/f/:shortId/draft

## 特殊处理
- 短链接生成
- 表单访问限制（密码、IP）
- 提交次数限制
- 文件上传处理
```

### 4. 数据分析

```
# 数据分析功能

## 功能范围
- 提交统计
- 题目分析
- 趋势图表
- 数据导出

## API 端点
- GET /api/forms/:id/analytics
- GET /api/forms/:id/analytics/trends
- GET /api/forms/:id/analytics/questions
- GET /api/forms/:id/export

## 数据处理
- 实时统计
- 缓存优化
- 大数据量分页
- 导出格式（CSV/Excel/JSON）
```

### 5. 模板系统

```
# 模板系统功能

## 功能范围
- 模板列表
- 使用模板
- 收藏模板
- 模板分类
- 模板搜索

## API 端点
- GET /api/templates
- GET /api/templates/:id
- POST /api/templates/:id/use
- POST /api/templates/:id/favorite

## 预置模板
- 投票类模板
- 问卷类模板
- 评分类模板
- 信息收集类模板
```

### 6. 通知系统

```
# 通知系统功能

## 功能范围
- 通知列表
- 通知标记已读
- 通知设置
- 实时推送

## 通知类型
- 表单提交通知
- 表单评论通知
- 系统通知
- @提及通知

## API 端点
- GET /api/notifications
- PUT /api/notifications/:id/read
- PUT /api/notifications/read-all
- GET /api/notifications/settings
- PUT /api/notifications/settings

## 实时推送
- WebSocket 连接
- 事件订阅
- 推送规则
```

## Bug 修复模板

### 提示词：修复 Bug

```
请帮我修复 MultiForms 项目中的 [Bug 描述]。

# Bug 信息

## 问题描述
[详细描述 Bug 表现]

## 复现步骤
1. [步骤1]
2. [步骤2]
3. [步骤3]

## 预期行为
[描述应该发生的正确行为]

## 实际行为
[描述当前发生的错误行为]

## 错误信息
[如果有错误信息/日志]

## 环境
- 浏览器: [浏览器名称及版本]
- 设备: [设备类型]
- 复现频率: [总是/偶尔/一次]

# 相关文件

[可能相关的文件路径]

# 修复要求

1. 定位问题根源
2. 提供修复方案
3. 确保不引入新问题
4. 添加必要的测试
5. 更新相关文档
```

## 性能优化模板

### 提示词：性能优化

```
请帮我优化 MultiForms 项目中 [功能/页面] 的性能。

# 优化目标

[描述优化目标，如：减少加载时间、提高响应速度等]

# 当前问题

[描述当前存在的性能问题]

## 性能指标
- 首屏加载时间: [当前值]
- 交互响应时间: [当前值]
- 包大小: [当前值]

# 优化方向

1. **代码分割**: [具体方案]
2. **懒加载**: [具体方案]
3. **缓存策略**: [具体方案]
4. **API 优化**: [具体方案]
5. **渲染优化**: [具体方案]

# 相关文件

[可能相关的文件路径]

# 输出要求

1. 分析性能瓶颈
2. 提供优化方案
3. 实现优化代码
4. 对比优化效果
```

## 代码重构模板

### 提示词：代码重构

```
请帮我重构 MultiForms 项目中的 [模块/组件]。

# 重构目标

[描述重构目标，如：提高可维护性、减少耦合、提升性能等]

# 当前问题

[描述当前代码存在的问题]

## 问题列表
1. [问题1]
2. [问题2]
3. [问题3]

# 重构要求

1. **单一职责**: 每个模块只做一件事
2. **降低耦合**: 减少模块间依赖
3. **提高复用**: 提取公共逻辑
4. **类型安全**: 完善类型定义
5. **错误处理**: 统一错误处理

# 输出要求

1. 分析当前代码结构
2. 提供重构方案
3. 实现重构代码
4. 确保功能不变
5. 更新测试用例
```

## 测试编写模板

### 提示词：编写测试

```
请为 MultiForms 项目的 [功能/组件] 编写测试。

# 测试目标

[描述要测试的功能/组件]

# 技术栈

- **测试框架**: Jest / Vitest
- **组件测试**: React Testing Library
- **E2E 测试**: Playwright / Cypress

# 测试覆盖

## 单元测试
- [测试场景1]
- [测试场景2]
- [测试场景3]

## 集成测试
- [测试场景1]
- [测试场景2]

## E2E 测试
- [测试场景1]

# 边界情况

- [边界情况1]
- [边界情况2]

# 输出要求

1. 创建测试文件
2. 编写测试用例
3. 覆盖主要场景
4. 测试边界情况
5. 确保测试通过
```

## Git 提交模板

### 提示词：生成提交信息

```
请根据以下更改生成 Git 提交信息。

# 更改内容

[列出所有更改的文件和内容]

# 更改类型

- [ ] feat: 新功能
- [ ] fix: 修复 Bug
- [ ] refactor: 重构
- [ ] style: 样式修改
- [ ] docs: 文档更新
- [ ] test: 测试相关
- [ ] chore: 构建/工具相关

# 影响范围

[描述更改影响的范围]

# 破坏性变更

[如有，描述破坏性变更]

# 输出要求

使用 Conventional Commits 格式:
<type>(<scope>): <subject>

<body>

<footer>
```

## 常用命令

### 前端

```bash
# 创建新功能组件
npx shadcn-ui@latest add [component-name]

# 类型检查
npm run type-check

# 代码检查
npm run lint

# 代码格式化
npm run format

# 运行测试
npm run test

# 构建生产版本
npm run build
```

### 后端 (Supabase)

```bash
# 生成 TypeScript 类型
supabase gen types typescript --project-id xxxxxxxx > lib/database.types.ts

# 创建新迁移
supabase migration new [migration_name]

# 推送数据库更改到远程
supabase db push

# 查看数据库状态
supabase status

# 打开 Supabase Dashboard
supabase dashboard

# 本地开发 (启动本地 Supabase)
supabase start
```
